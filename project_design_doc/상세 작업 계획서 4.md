---
root_main: "[[í”„ë¡œì íŠ¸/í”„ë¡œì íŠ¸_main|í”„ë¡œì íŠ¸_main]]"
deps: 0
title: ìƒì„¸ ì‘ì—… ê³„íšì„œ 4
Project: 
Domain: 
Object: 
Scope: 
Asset: 
Source:
Maturity (%): 
entity_type: 
created: 2025-06-26
modified: 2025-06-26 14:00
folder_main: "[[í”„ë¡œì íŠ¸/í”„ë¡œì íŠ¸_main|í”„ë¡œì íŠ¸_main]]"
related_files:
---
### **Part 4: í”„ë ˆì  í…Œì´ì…˜ ê³„ì¸µ ìƒì„¸ ì„¤ê³„ (src/app.py) (ì‹¬í™”)**

ì´ì „ íŒŒíŠ¸ì—ì„œ src/app.pyì˜ ê¸°ë³¸ êµ¬ì¡°ì™€ ë¡œì§ íë¦„ì„ ì„¤ê³„í–ˆë‹¤. ì´ íŒŒíŠ¸ì—ì„œëŠ” ì‚¬ìš©ì ê²½í—˜(UX)ì„ ê·¹ëŒ€í™”í•˜ê¸° ìœ„í•œ êµ¬ì²´ì ì¸ ì‹œê°í™” ì»´í¬ë„ŒíŠ¸ êµ¬í˜„ ë°©ë²•ì„ ìƒì„¸íˆ ì •ì˜í•œë‹¤.

#### **4.1. ë©”ì¸ ê²°ê³¼ ë””ìŠ¤í”Œë ˆì´ ìƒì„¸ ì„¤ê³„**

st.session\_state.resultsê°€ ì±„ì›Œì¡Œì„ ë•Œ, ë©”ì¸ í™”ë©´ì— í‘œì‹œë  ê° ì»´í¬ë„ŒíŠ¸ì˜ ëª…ì„¸ì´ë‹¤.

1. **í˜ë¥´ì†Œë‚˜ ë¶„ì„ ê²°ê³¼ (st.expander)**:  
   * **ì»´í¬ë„ŒíŠ¸**: st.expander("ì„ íƒëœ í˜ë¥´ì†Œë‚˜ ë¶„ì„ ê²°ê³¼ ë³´ê¸°")ë¥¼ ì‚¬ìš©í•˜ì—¬ ê¸°ë³¸ì ìœ¼ë¡œ ë‚´ìš©ì„ ìˆ¨ê¸°ê³ , ì‚¬ìš©ìê°€ ì›í•  ë•Œ í¼ì³ë³¼ ìˆ˜ ìˆë„ë¡ í•œë‹¤.  
   * **ë‚´ë¶€ ë ˆì´ì•„ì›ƒ**: st.columns(2)ë¥¼ ì‚¬ìš©í•˜ì—¬ 2ë‹¨ ë ˆì´ì•„ì›ƒìœ¼ë¡œ êµ¬ì„±í•œë‹¤.  
     * **ì¢Œì¸¡ ì»¬ëŸ¼**:  
       * st.subheader(f"ğŸ‘¤ {persona\_name}")  
       * st.caption(f"{persona\_description}")  
       * st.markdown("---")  
       * st.write("ğŸ“ˆ \*\*ê°€ìƒ ì‹œì²­ ê¸°ë¡ (Top 10)\*\*")  
       * st.dataframe(dummy\_watch\_history.head(10))ë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±ëœ ì‹œì²­ ê¸°ë¡ ì¼ë¶€ë¥¼ í…Œì´ë¸”ë¡œ í‘œì‹œí•œë‹¤.  
     * **ìš°ì¸¡ ì»¬ëŸ¼**:  
       * st.write("ğŸ§  \*\*ì ì¬ ì„ í˜¸ ì˜í™” í´ëŸ¬ìŠ¤í„° ë° AI ìƒì„± ë¼ë²¨\*\*")  
       * top\_k\_movies\_with\_labels ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒí•˜ë©° ê° ì˜í™” ì •ë³´ë¥¼ ì¹´ë“œ í˜•íƒœë¡œ í‘œì‹œí•œë‹¤.  
       * **ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ ì˜ì‚¬ ì½”ë“œ**:  
         \# In app.py  
         for movie in results\['top\_k\_movies\_with\_labels'\]:  
             with st.container():  
                 st.markdown(f"\*\*{movie\['title'\]}\*\* (ì˜ˆìƒ í‰ì : {movie\['predicted\_rating'\]:.1f})")  
                 \# ë¼ë²¨ë“¤ì„ st.button(disabled=True)ë¥¼ ì‚¬ìš©í•´ íƒœê·¸ì²˜ëŸ¼ ë³´ì´ê²Œ í•¨  
                 cols \= st.columns(5)   
                 for i, label in enumerate(movie\['labels'\]\[:5\]):  
                     cols\[i % 5\].button(label, key=f"{movie\['title'\]}\_{label}", disabled=True)

2. **ì‹¤ì‹œê°„ ì±„ë„ ì¶”ì²œ ê²°ê³¼**:  
   * st.subheader("ğŸ“º ì§€ê¸ˆ ì‹œì²­í•  ë§Œí•œ ì±„ë„ ì¶”ì²œ")  
   * results\['recommendations'\] ë¦¬ìŠ¤íŠ¸ë¥¼ ìˆœíšŒí•˜ë©° ê° ì¶”ì²œ í•­ëª©ì„ í‘œì‹œí•œë‹¤.  
   * **ì»¤ìŠ¤í…€ ì¹´ë“œ ì»´í¬ë„ŒíŠ¸ ì„¤ê³„ (HTML/CSS ì‚¬ìš©)**: st.markdownì˜ unsafe\_allow\_html=True ì˜µì…˜ì„ í™œìš©í•˜ì—¬ UIë¥¼ ë¯¸ë ¤í•˜ê²Œ ê¾¸ë¯¼ë‹¤.  
     * **ì¹´ë“œ êµ¬ì¡°**:  
       * ì±„ë„ ë¡œê³  (ì´ë¯¸ì§€ íŒŒì¼ ë˜ëŠ” ì´ëª¨ì§€)  
       * ì±„ë„ëª… ë° ì±„ë„ ë²ˆí˜¸  
       * í”„ë¡œê·¸ë¨ ì œëª© ë° íšŒì°¨ ì •ë³´  
       * ë°©ì˜ ì‹œê°„ (e.g., 21:00 \~ 22:30)  
       * ìœ ì‚¬ë„ ì ìˆ˜ë¥¼ ì‹œê°í™”í•œ í”„ë¡œê·¸ë ˆìŠ¤ ë°”  
       * AIê°€ ë¶„ì„í•œ ì¶”ì²œ ì´ìœ   
       * 'ì´ì–´ì„œ ë³´ê¸°' ë²„íŠ¼  
     * **HTML/CSS ì˜ˆì‹œ ì½”ë“œ**:  
       \# In app.py, to be used inside a loop  
       def create\_recommendation\_card(program\_data):  
           card\_html \= f"""  
           \<div style="border: 1px solid \#e6e6e6; border-radius: 10px; padding: 15px; margin-bottom: 10px; box-shadow: 2px 2px 8px rgba(0,0,0,0.1);"\>  
               \<h3 style="margin-bottom: 5px;"\>{program\_data\['channel'\]} \- {program\_data\['title'\]}\</h3\>  
               \<p style="font-size: 0.9em; color: grey;"\>{program\_data\['start\_time'\]} \~ {program\_data\['end\_time'\]}\</p\>  
               \<label\>AI ì¶”ì²œ ìœ ì‚¬ë„: {int(program\_data\['similarity\_score'\] \* 100)}%\</label\>  
               \<progress value="{program\_data\['similarity\_score'\]}" max="1" style="width: 100%;"\>\</progress\>  
               \<p style="font-size: 0.9em; margin-top: 10px;"\>\<b\>ì¶”ì²œ ì´ìœ :\</b\> {program\_data\['reason'\]}\</p\>  
           \</div\>  
           """  
           st.markdown(card\_html, unsafe\_allow\_html=True)

       \# ... loop ...  
       \# create\_recommendation\_card(program)  
       \# if st.button("â–¶ï¸ ì´ í”„ë¡œê·¸ë¨ ë‹¤ìŒ ì±„ë„ ì¶”ì²œ", key=f"next\_up\_{program\['title'\]}"):  
       \#    \# Next-Up ë¡œì§ ì‹¤í–‰

   * 'ì´ì–´ì„œ ë³´ê¸°' ë¡œì§ì€ st.session\_stateë¥¼ í™œìš©í•˜ì—¬ ìƒíƒœë¥¼ ê´€ë¦¬í•œë‹¤. ë²„íŠ¼ì´ í´ë¦­ë˜ë©´, st.session\_state.current\_selection\_end\_timeì— í•´ë‹¹ í”„ë¡œê·¸ë¨ì˜ ì¢…ë£Œ ì‹œê°„ì„ ì €ì¥í•˜ê³ , í˜ì´ì§€ë¥¼ ë‹¤ì‹œ ì‹¤í–‰(st.rerun())í•˜ì—¬ ë‹¤ìŒ ì¶”ì²œ ëª©ë¡ì„ ê·¸ë¦¬ë„ë¡ ìœ ë„í•œë‹¤.

### **Part 5: ìœ í‹¸ë¦¬í‹° ë° ì—ëŸ¬ ì²˜ë¦¬ ìƒì„¸ ì„¤ê³„**

í”„ë¡œì íŠ¸ ì „ë°˜ì˜ ì½”ë“œ í’ˆì§ˆ, ì•ˆì •ì„±, ìœ ì§€ë³´ìˆ˜ì„±ì„ í–¥ìƒì‹œí‚¤ê¸° ìœ„í•œ ê³µí†µ ëª¨ë“ˆê³¼ ì „ëµì„ ì„¤ê³„í•œë‹¤.

#### **5.1. ëª¨ë“ˆ 7: ê³µí†µ í—¬í¼ (src/utils/helpers.py)**

* **íŒŒì¼**: src/utils/helpers.py  
* **ì—­í• **: íŠ¹ì • ë„ë©”ì¸ì— ì¢…ì†ë˜ì§€ ì•ŠëŠ” ë²”ìš© í•¨ìˆ˜ë“¤ì„ ëª¨ì•„ë†“ì€ ìœ í‹¸ë¦¬í‹° ëª¨ë“ˆ.  
* **í¬í•¨ë  í•¨ìˆ˜ ëª…ì„¸**:  
  * **load\_config(path: str) \-\> dict**:  
    * YAML ì„¤ì • íŒŒì¼ì„ ì•ˆì „í•˜ê²Œ ë¡œë“œí•˜ì—¬ ë”•ì…”ë„ˆë¦¬ë¡œ ë°˜í™˜í•œë‹¤.  
  * **get\_project\_root() \-\> Path**:  
    * í”„ë¡œì íŠ¸ì˜ ë£¨íŠ¸ ë””ë ‰í† ë¦¬ ê²½ë¡œë¥¼ ë°˜í™˜í•˜ì—¬, ì–´ë–¤ ìœ„ì¹˜ì—ì„œ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‹¤í–‰í•´ë„ íŒŒì¼ ê²½ë¡œê°€ ê¹¨ì§€ì§€ ì•Šë„ë¡ ë³´ì¥í•œë‹¤.  
  * **setup\_logger(config\_path: str)**:  
    * config/logging\_config.json íŒŒì¼ì„ ì½ì–´ Pythonì˜ logging ëª¨ë“ˆì„ ì „ì—­ì ìœ¼ë¡œ ì„¤ì •í•œë‹¤. ì´ë¥¼ í†µí•´ ëª¨ë“  ëª¨ë“ˆì—ì„œ ì¼ê´€ëœ í˜•ì‹ì˜ ë¡œê·¸ë¥¼ ë‚¨ê¸¸ ìˆ˜ ìˆë‹¤.  
  * **time\_formatter(dt\_obj: datetime, format: str) \-\> str**:  
    * datetime ê°ì²´ë¥¼ ì§€ì •ëœ í¬ë§·ì˜ ë¬¸ìì—´ë¡œ ë³€í™˜í•œë‹¤.  
  * **calculate\_cosine\_similarity(vec1, vec2)**:  
    * ë‘ ê°œì˜ numpy ë°°ì—´(ë²¡í„°)ì„ ì…ë ¥ë°›ì•„ ì½”ì‚¬ì¸ ìœ ì‚¬ë„ë¥¼ ê³„ì‚°í•˜ì—¬ ë°˜í™˜í•œë‹¤.

#### **5.2. ì „ì—­ ì—ëŸ¬ ì²˜ë¦¬ ë° ë¡œê¹… ì „ëµ**

* **ë¡œê¹… ì„¤ì • (config/logging\_config.json)**:  
  * **ëª©í‘œ**: ë¡œê·¸ ë ˆë²¨(DEBUG, INFO, WARNING, ERROR)ì— ë”°ë¼ ë‹¤ë¥¸ í•¸ë“¤ëŸ¬(ì½˜ì†”, íŒŒì¼)ë¥¼ ì‚¬ìš©í•˜ê³ , ì¼ê´€ëœ í¬ë§·ì„ ìœ ì§€í•œë‹¤.  
  * **ì˜ˆì‹œ êµ¬ì¡°**:  
    {  
      "version": 1,  
      "disable\_existing\_loggers": false,  
      "formatters": {  
        "standard": {  
          "format": "%(asctime)s \- %(name)s \- %(levelname)s \- %(message)s"  
        }  
      },  
      "handlers": {  
        "console": {  
          "class": "logging.StreamHandler",  
          "formatter": "standard",  
          "level": "INFO"  
        },  
        "file": {  
          "class": "logging.handlers.RotatingFileHandler",  
          "formatter": "standard",  
          "filename": "logs/app.log",  
          "maxBytes": 10485760,  
          "backupCount": 5,  
          "level": "DEBUG"  
        }  
      },  
      "root": {  
        "handlers": \["console", "file"\],  
        "level": "DEBUG"  
      }  
    }

  * ì• í”Œë¦¬ì¼€ì´ì…˜ ì‹œì‘ ì‹œ setup\_loggerë¥¼ í˜¸ì¶œí•˜ì—¬ ì´ ì„¤ì •ì„ ì ìš©í•œë‹¤.  
  * ëª¨ë“  print() ë¬¸ì€ logging.info() ë˜ëŠ” logging.debug() ë“±ìœ¼ë¡œ ëŒ€ì²´í•œë‹¤.  
* **ì»´í¬ë„ŒíŠ¸ë³„ ì˜ˆì™¸ ì²˜ë¦¬**:  
  * **API í˜¸ì¶œ**: ContentLabeler, ScheduleCrawler ë“± ì™¸ë¶€ ì„œë¹„ìŠ¤ì™€ í†µì‹ í•˜ëŠ” ëª¨ë“  ì»´í¬ë„ŒíŠ¸ëŠ” try-except ë¸”ë¡ ë‚´ì—ì„œ ì‹¤í–‰ë˜ì–´ì•¼ í•˜ë©°, ì¬ì‹œë„ ë¡œì§ì„ í¬í•¨í•´ì•¼ í•œë‹¤. (Part 2ì—ì„œ ì„¤ê³„ë¨)  
  * **íŒŒì¼ I/O**: DataLoader ë“± íŒŒì¼ì„ ì½ê³  ì“°ëŠ” ëª¨ë“  ì‘ì—…ì€ FileNotFoundError, PermissionError ë“±ì„ ì²˜ë¦¬í•˜ëŠ” try-except ë¸”ë¡ìœ¼ë¡œ ê°ì‹¸ì•¼ í•œë‹¤.  
  * **ëª¨ë¸ ë¡œë”©/ì¶”ë¡ **: RatingPredictorì—ì„œ ëª¨ë¸ íŒŒì¼ ë¡œë”© ì‹¤íŒ¨ ë˜ëŠ” ì¶”ë¡  ì¤‘ ë°œìƒí•˜ëŠ” í…ì„œ í¬ê¸° ë¶ˆì¼ì¹˜ ë“±ì˜ ì—ëŸ¬ëŠ” ëª…ì‹œì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³ , ì‚¬ìš©ìì—ê²Œ ì¹œí™”ì ì¸ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•´ì•¼ í•œë‹¤.  
  * RecommendationEngineì—ì„œëŠ” ê° ì»´í¬ë„ŒíŠ¸ë¥¼ í˜¸ì¶œí•  ë•Œ ë°œìƒí•˜ëŠ” ì˜ˆì™¸ë¥¼ ìµœì¢…ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³ , Streamlit UIì— ì—ëŸ¬ ìƒíƒœë¥¼ ì „ë‹¬í•˜ì—¬ st.error() ë©”ì‹œì§€ë¥¼ í‘œì‹œí•˜ë„ë¡ í•œë‹¤.

#### **5.3. ë°ì´í„° ìœ íš¨ì„± ê²€ì‚¬ (Data Validation)**

* **ëª©í‘œ**: ê° ì»´í¬ë„ŒíŠ¸ ê°„ì— ì „ë‹¬ë˜ëŠ” ë°ì´í„°ì˜ í˜•ì‹ì„ ë³´ì¥í•˜ì—¬ ì˜ˆê¸°ì¹˜ ì•Šì€ íƒ€ì… ì—ëŸ¬ë¥¼ ë°©ì§€í•œë‹¤. Pydantic ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©ì„ ê¶Œì¥í•œë‹¤.  
* **êµ¬í˜„ ë°©ì•ˆ**:  
  * ê° ì£¼ìš” ë°ì´í„° êµ¬ì¡°(e.g., í¸ì„±í‘œ í”„ë¡œê·¸ë¨ ì •ë³´, ìµœì¢… ì¶”ì²œ ê²°ê³¼)ì— ëŒ€í•œ Pydantic ëª¨ë¸ì„ src/core/schemas.py íŒŒì¼ì— ì •ì˜í•œë‹¤.  
  * **ì˜ˆì‹œ (src/core/schemas.py)**:  
    from pydantic import BaseModel, HttpUrl  
    from typing import List  
    from datetime import datetime

    class ProgramItem(BaseModel):  
        channel: str  
        title: str  
        start\_time: datetime  
        end\_time: datetime  
        similarity\_score: float  
        reason: str

    class RecommendationResult(BaseModel):  
        persona\_info: dict  
        dummy\_watch\_history: List\[dict\]  
        top\_k\_movies\_with\_labels: List\[dict\]  
        recommendations: List\[ProgramItem\]

  * RecommendationEngineì˜ generate\_recommendations\_for\_persona ë©”ì„œë“œëŠ” ìµœì¢… ë°˜í™˜ ì§ì „ì— RecommendationResult(\*\*output\_dict)ì™€ ê°™ì´ Pydantic ëª¨ë¸ë¡œ ë°ì´í„°ë¥¼ ê²€ì¦í•œë‹¤. ìœ íš¨ì„± ê²€ì‚¬ì— ì‹¤íŒ¨í•˜ë©´ ValidationErrorê°€ ë°œìƒí•˜ë©°, ì´ë¥¼ try-exceptë¡œ ì¡ì•„ ë””ë²„ê¹…ì— í™œìš©í•œë‹¤.

**(ë‹¤ìŒ íŒŒíŠ¸ì—ì„œ ê³„ì†ë©ë‹ˆë‹¤...)**